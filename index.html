<!DOCTYPE html>
<html>
<head>
    <title>兰宇昕的网页</title>
    <style>
        body { 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 20px; 
            font-family: Arial; 
        }
        .ai-chat { 
            margin-top: 30px; 
            border: 1px solid #ddd; 
            padding: 20px; 
            border-radius: 10px; 
        }
        .chat-messages { 
            height: 300px; 
            overflow-y: auto; 
            margin: 10px 0; 
            padding: 10px; 
            background: #f9f9f9; 
            border-radius: 5px; 
        }
        .message { 
            margin: 5px 0; 
            padding: 8px; 
            border-radius: 4px; 
        }
        .user { 
            background: #e1f5fe; 
            text-align: right; 
        }
        .assistant { 
            background: #f1f8e9; 
            text-align: left; 
        }
        input { 
            width: 70%; 
            padding: 8px; 
            margin-right: 10px; 
        }
        button { 
            padding: 8px 15px; 
            background: #4CAF50; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
        }
    </style>
</head>
<body>
    <h1>请给出各工序的数据</h1>
    
    <!-- AI对话区域 -->
    <div class="ai-chat">
        <h3>AI小助手</h3>
        <div class="chat-messages" id="chatMessages"></div>
        <input type="text" id="userInput" placeholder="请输入你的问题...">
        <button onclick="sendMessage()">发送</button>
    </div>

    <script>
        // 存储对话历史
        let chatHistory = [];
        // 替换为你的腾讯云函数URL
        const backendUrl = "https://1383277634-5ic4c9jaoo.ap-beijing.tencentscf.com";

        // 发送消息给AI
        function sendMessage() {
            const input = document.getElementById('userInput').value.trim();
            if (!input) return; // 空消息不发送

            // 显示用户的消息
            addMessage("user", input);
            document.getElementById('userInput').value = ""; // 清空输入框

            // 把用户消息加入历史
            chatHistory.push({ role: "user", content: input });

            // 调用后端接口，获取AI回答
            fetch(backendUrl, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ messages: chatHistory })
            })
            .then(response => response.json())
            .then(data => {
                // 显示AI的回答
                addMessage("assistant", data.content);
                // 把AI回答加入历史
                chatHistory.push({ role: "assistant", content: data.content });
            })
            .catch(error => {
                addMessage("assistant", "抱歉，暂时无法回答~");
            });
        }

        // 在页面上显示消息
        function addMessage(role, content) {
            const chatDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            messageDiv.textContent = content;
            chatDiv.appendChild(messageDiv);
            // 自动滚动到底部
            chatDiv.scrollTop = chatDiv.scrollHeight;
        }
    </script>
</body>
</html>
